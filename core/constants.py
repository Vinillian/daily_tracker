import os
import sys
from pathlib import Path
from typing import List, Dict


# ะะฟัะตะดะตะปัะตะผ ะฑะฐะทะพะฒัั ะฟะฐะฟะบั ะดะปั ะดะฐะฝะฝัั
def get_base_dir():
    """ะะฟัะตะดะตะปัะตะผ ะณะดะต ััะฐะฝะธัั ะดะฐะฝะฝัะต - ะฒ ะฟะฐะฟะบะต ะฟะพะปัะทะพะฒะฐัะตะปั"""
    if getattr(sys, 'frozen', False):
        # ะัะปะธ ะทะฐะฟััะตะฝะพ ะบะฐะบ exe - ะดะฐะฝะฝัะต ะฒ AppData/Roaming
        base_dir = Path(os.path.expanduser("~")) / "AppData" / "Roaming" / "DailyTracker"
    else:
        # ะัะปะธ ะทะฐะฟััะตะฝะพ ะบะฐะบ ัะบัะธะฟั - ะฒ ะฟะฐะฟะบะต ะฟัะพะตะบัะฐ
        base_dir = Path(__file__).parent.parent

    # ะะฝะธัะธะฐะปะธะทะธััะตะผ ะฟัะธะปะพะถะตะฝะธะต (ัะฐัะฟะฐะบะพะฒัะฒะฐะตะผ ัะฐะฑะปะพะฝั)
    try:
        from init_app import init_app
        base_dir = init_app()
    except Exception as e:
        print(f"โ๏ธ ะัะธะฑะบะฐ ะธะฝะธัะธะฐะปะธะทะฐัะธะธ: {e}")

    # ะกะพะทะดะฐะตะผ ะฝะตะพะฑัะพะดะธะผัะต ะฟะฐะฟะบะธ
    data_dir = base_dir / "data"
    data_dir.mkdir(parents=True, exist_ok=True)

    diary_dir = data_dir / "diary"
    diary_dir.mkdir(exist_ok=True)

    projects_dir = data_dir / "projects"
    projects_dir.mkdir(exist_ok=True)

    config_dir = base_dir / "config"
    config_dir.mkdir(exist_ok=True)

    return base_dir


BASE_DIR = get_base_dir()

# ะััะธ
DATA_DIR = BASE_DIR / "data"
DIARY_DIR = DATA_DIR / "diary"
PROJECTS_DIR = DATA_DIR / "projects"
TEMPLATE_DIR = BASE_DIR / "templates"
PROJECT_TEMPLATES_DIR = BASE_DIR / "templates" / "project_templates"

# ะกะพะทะดะฐะตะผ ะฟะฐะฟะบะธ ะตัะปะธ ะฝะต ัััะตััะฒััั
for directory in [DATA_DIR, DIARY_DIR, PROJECTS_DIR, TEMPLATE_DIR, PROJECT_TEMPLATES_DIR]:
    directory.mkdir(parents=True, exist_ok=True)

# ะะตัะธะพะดั ะดะฝั
DAY_PERIODS = ["ะฃััะพ", "ะะตะฝั", "ะะตัะตั"]
PERIOD_ICONS = {"ะฃััะพ": "๐", "ะะตะฝั": "๐", "ะะตัะตั": "๐"}

# ะกัะฐัััั ะทะฐะดะฐั
TASK_STATUSES = ["โ", "โ", "โ๏ธ", "โ"]
STATUS_EMOJIS = {"โ": "โช", "โ": "๐ข", "โ๏ธ": "๐ก", "โ": "๐ด"}

CATEGORIES = [
    "๐ฉบ ะะดะพัะพะฒัะต", "๐ผ ะะฐะฑะพัะฐ", "๐ ะะฑััะตะฝะธะต",
    "๐ง ะัะฐะบัะธะบะธ", "๐ ะัั", "๐ญ ะัะดัั",
    "๐ฅ ะะฑัะตะฝะธะต", "๐ ะัะฝะพัะตะฝะธั", "๐ฑ ะะฐะทะฒะธัะธะต",
    "๐จ ะขะฒะพััะตััะฒะพ", "๐ ะกะฟะพัั", "๐ ะััะพะฒะฝะพะต",
    "๐ฐ ะคะธะฝะฐะฝัั", "๐ ะัะพะตะบัั", "๐ ะััะตัะตััะฒะธั"
]

# ะะฒัะพะผะฐัะธัะตัะบะธะต ะบะฐัะตะณะพัะธะธ (ะบะปััะตะฒัะต ัะปะพะฒะฐ)
AUTO_CATEGORIES: Dict[str, List[str]] = {
    "๐ฉบ ะะดะพัะพะฒัะต": ["๐ฉบ", "๐", "๐", "ะฒัะฐั", "ะฑะพะปัะฝะธั", "ะทะดะพัะพะฒั", "ะฝะตะนัะพัะธัััะณ", "ะฟัะธัะผ", "ะบะพะฝััะปััะฐัะธั", "ะดะธะฐะณะฝะพััะธะบะฐ"],
    "๐ผ ะะฐะฑะพัะฐ": ["๐ฆ", "๐ผ", "๐", "ะบัััะตั", "ัะฐะฑะพั", "ะดะพัะพะด", "ะทะฐัะฐะฑะฐั", "ะฟัะพะตะบั"],
    "๐ ะะฑััะตะฝะธะต": ["๐", "๐งฎ", "๐", "python", "ะธะทััะตะฝะธะต", "ะปะตะบัะธั", "ััะตะฝะธะต", "ะผะฐัะบ ะปััั", "ะบะปะฐัั", "ะฐััะธะฑัั",
                   "ะฟัะพะณัะฐะผะผะธัะพะฒะฐะฝะธะต"],
    "๐ง ะัะฐะบัะธะบะธ": ["๐๏ธ", "๐ง", "โฏ๏ธ", "ะผะตะดะธัะฐั", "ะผะฐะฝััะฐ", "ัะฐัััะถะบะฐ", "ะดะฐะพัะธะทะผ", "ะดััะพะฒะฝ", "ะฟัะฐะบัะธะบ"],
    "๐ ะัั": ["๐", "๐๏ธ", "โ", "๐ฝ๏ธ", "๐", "ัะฑะพัะบ", "ะทะฐะฒััะฐะบ", "ัะถะธะฝ", "ัะฑะพั", "ะดะพะบัะผะตะฝั", "ะดะพะผ"],
    "๐ญ ะัะดัั": ["๐บ", "๐ฌ", "๐ถ", "ัะตัะธะฐะป", "ะพัะดัั", "ะฟัะพะณัะปะบะฐ", "ัะฐะทะณะพะฒะพั", "ัะพะฑะฑะธ", "ัะฐะทะฒะปะตัะตะฝ"]
}

# ะัะตะผะตะฝะฝัะต ะธะฝัะตัะฒะฐะปั
TIME_SLOTS = [f"{hour:02d}:{minute:02d}" for hour in range(0, 24) for minute in [0, 15, 30, 45]]
POPULAR_TIME_RANGES = [
    "07:00โ08:00", "08:00โ09:00", "09:00โ10:00", "10:00โ11:00",
    "11:00โ12:00", "12:00โ13:00", "13:00โ14:00", "14:00โ15:00",
    "15:00โ16:00", "16:00โ17:00", "17:00โ18:00", "18:00โ19:00",
    "19:00โ20:00", "20:00โ21:00", "21:00โ22:00", "22:00โ23:00"
]